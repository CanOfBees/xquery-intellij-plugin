<!DOCTYPE idea-plugin PUBLIC "Plugin/DTD" "https://plugins.jetbrains.com/plugin.dtd">
<idea-plugin xmlns:xi="http://www.w3.org/2001/XInclude">
  <id>uk.co.reecedunn.intellij.plugin.xquery</id>
  <!--suppress PluginXmlValidity -->
  <name>XQuery IntelliJ Plugin</name>
  <version>VERSION</version>
  <vendor email="msclrhd@gmail.com" url="http://reecedunn.co.uk">Reece H. Dunn</vendor>
  <category>XML</category>

  <depends>com.intellij.modules.lang</depends>
  <depends>com.intellij.modules.xdebugger</depends>
  <depends>com.intellij.modules.xml</depends>
  <depends>com.intellij.properties</depends>

  <depends optional="true" config-file="plugin-depends-intellilang.xml">org.intellij.intelliLang</depends>
  <depends optional="true" config-file="plugin-depends-java.xml">com.intellij.modules.java</depends>
  <depends optional="true" config-file="plugin-depends-microservices.xml">com.intellij.modules.microservices</depends>

  <description><![CDATA[
    <p>
      XQuery 1.0-3.1, XPath 2.0-3.1, and XSLT 3.0 language support with BaseX,
      MarkLogic, Saxon, and W3C extensions; run, debug, and profile queries;
      log viewer; and more.
    </p>
    <p>&#xA0;</p>
    <p>Query processor integration:</p>
    <ol>
      <li>Run BaseX, eXist-db, FusionDB, MarkLogic, and Saxon queries.</li>
      <li>Profile BaseX, MarkLogic, and Saxon XQuery and XSLT files.</li>
      <li>Debug MarkLogic XQuery files, with expression breakpoint support.</li>
      <li>Log viewer for BaseX and MarkLogic.</li>
      <li>Built-in namespace and function support for BaseX, eXist-db, MarkLogic, and Saxon.</li>
      <li>Support for MarkLogic rewriter XML files and EXQuery RESTXQ endpoints.</li>
    </ol>
    <p>Library and Framework integration:</p>
    <ol>
      <li>MarkLogic Roxy &ndash; source root detection.</li>
      <li>MarkLogic ml-gradle &ndash; source root detection.</li>
      <li>Support running and profiling XRay unit tests.</li>
    </ol>
    <p>XPath and XSLT:</p>
    <ol>
      <li>XSLT 3.0 XMLSchema support.</li>
      <li>Experimental XPath support when the IntelliJ XPathView plugin is disabled.</li>
      <li>Support parsing XSLT 1.0, 2.0, and 3.0 schema types.</li>
      <li>Support XSLT 3.0 text value templates.</li>
    </ol>
    <p>IntelliJ integration:</p>
    <ol>
      <li>Robust syntax highlighting and error reporting.</li>
      <li>Inspections for several XPath/XQuery static errors.</li>
      <li>Navigate to file, namespace, variable, and function.</li>
      <li>Find usages and semantic usage highlighting.</li>
      <li>Rename refactoring for variables.</li>
      <li>Function, variable, and QName prefix signature tooltips via Ctrl.</li>
      <li>Code folding.</li>
      <li>Code completion.</li>
      <li>Parameter information tooltips and inlay hints.</li>
      <li>Structure view, including on the navigation bar in IntelliJ 2020.1+.</li>
      <li>Breadcrumb navigation, including highlighting XML tags in the editor like the IntelliJ XML plugin.</li>
      <li>Paired brace matching.</li>
      <li>Commenting code.</li>
      <li>Integrated function documentation ("Quick Documentation", Ctrl+Q).</li>
      <li>Context information (Alt+Q) for XQuery function declarations.</li>
      <li>Spellchecking support with bundle dictionaries with XPath, XQuery, and XSLT terms.</li>
      <li>Language injection support on various elements, including string literals.</li>
    </ol>
    <p>IntelliJ Ultimate integration:</p>
    <ol>
      <li>Support displaying MarkLogic rewriter files in the Endpoints tool window.</li>
      <li>Support displaying EXQuery RESTXQ endpoints in the Endpoints tool window.</li>
    </ol>
  ]]></description>

  <change-notes><![CDATA[
    <p>XPath, XQuery, and XSLT 4.0 Editor's Draft 13 January 2021:</p>
    <ol>
      <li>Add the XSLT 4.0 Editor's Draft XMLSchema file.</li>
      <li>Support any <code>ItemType</code> on <code>LocalUnionType</code> and <code>TypedMapTest</code>.</li>
      <li>Support nesting <code>TernaryConditionalExpr</code> expressions.</li>
      <li>
        Support <code>-&gt;</code> in addition to <code>function</code> in <code>InlineFunctionExpr</code>
        expressions, with optional function signatures.
      </li>
      <li>Support <code>-&gt;</code> based <code>ArrowExpr</code> expressions.</li>
      <li>Support named arguments in function calls.</li>
      <li>Support <code>RecordTest</code> and <code>EnumerationType</code> item types.</li>
      <li>Support <code>StringLiteral</code> and <code>VarRef</code> for <code>Lookup</code> and <code>UnaryLookup</code>.</li>
      <li>Support <code>WithExpr</code> expressions.</li>
      <li>Support <code>type</code> in <code>DefaultNamespaceDecl</code> declarations in XQuery.</li>
      <li>Support item type declarations in XQuery.</li>
    </ol>
    <p>XQuery:</p>
    <ol>
      <li>Support resolving wildcard prefixes to the namespace declaration.</li>
      <li>Fix an exception in code completion when typing in a comment after a variable reference.</li>
      <li>Show public/private icons in the file structure view.</li>
    </ol>
    <p>XProc:</p>
    <ol>
      <li>Recognise xpl files as XProc XML files.</li>
      <li>Add the XProc 1.0 RNG schema file.</li>
    </ol>
    <p>XRay Unit Tests:</p>
    <ol>
      <li>Add an XRay run configuration.</li>
      <li>Support running and profiling XRay unit tests.</li>
      <li>Add run actions in the line marker area.</li>
      <li>Support run actions on the context menu for files and directories.</li>
      <li>Report test status in the run console.</li>
    </ol>
    <p>Semantic Highlighting:</p>
    <ol>
      <li>Fix highlighting <code>xmlns</code> namespace prefix in contexts other than XML attributes.</li>
      <li>Fix highlighting variables that do not resolve to a variable declaration or binding.</li>
      <li>Fix highlighting wildcard element and attribute names.</li>
      <li>Highlight the <code>CompNamespaceConstructor</code> name as a namespace prefix.</li>
      <li>Highlight <code>KeySeparator</code> names and <code>RecordTest</code> field names as map keys.</li>
      <li>Highlight <code>PITest</code> and <code>CompPIConstructor</code> names as processing instructions.</li>
      <li>Highlight <code>KeywordArgument</code> names as parameters.</li>
      <li>Highlight <code>WithExpr</code> using the same logic as <code>DirAttribute</code>.</li>
    </ol>
    <p>Run Configuration:</p>
    <ol>
      <li>Support using the modules database for selected MarkLogic app-server.</li>
      <li>Filter the app-servers to the ones that match the selected database.</li>
      <li>Fix some encoding issues in handling UTF-8 output for MarkLogic.</li>
      <li>Report test status in the run console.</li>
      <li>Fix reformatting the output when the option is specified in the configuration.</li>
      <li>Fix locating relative modules and includes in Saxon queries.</li>
    </ol>
    <p>Query Log Viewer:</p>
    <ol>
      <li>Support syntax highlighting MarkLogic error log files open in the editor.</li>
    </ol>
    <p>Debugging:</p>
    <ol>
      <li>Fix displaying the expression breakpoint range in the editor.</li>
    </ol>
  ]]></change-notes>

  <idea-version since-build="161"/>

  <xi:include href="plugin-lang-xpm.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="plugin-lang-xpath.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="plugin-lang-xquery.xml" xpointer="xpointer(/idea-plugin/*)"/>

  <xi:include href="plugin-lang-xslt.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="plugin-lang-xproc.xml" xpointer="xpointer(/idea-plugin/*)"/>

  <xi:include href="plugin-inspections-ijvs.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="plugin-inspections-xpst.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="plugin-inspections-xqst.xml" xpointer="xpointer(/idea-plugin/*)"/>

  <xi:include href="plugin-documentation.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="plugin-query-processors.xml" xpointer="xpointer(/idea-plugin/*)"/>

  <xi:include href="plugin-marklogic.xml" xpointer="xpointer(/idea-plugin/*)"/>

  <extensions defaultExtensionNs="com.intellij">
    <applicationConfigurable groupId="language" displayName="XQuery and XSLT" id="preferences.xqueryAndXslt"
                             instance="uk.co.reecedunn.intellij.plugin.xpm.project.settings.XpmLanguageConfigurable"/>

    <applicationConfigurable groupId="language" displayName="Documentation Sources" id="preferences.xqueryAndXslt.documentation"
                             instance="uk.co.reecedunn.intellij.plugin.xqdoc.documentation.settings.XQDocDocumentationSourcesConfigurable"
                             parentId="preferences.xqueryAndXslt"/>

    <projectConfigurable groupId="language" displayName="Modules and Packages" id="preferences.xqueryAndXslt.modules"
                         instance="uk.co.reecedunn.intellij.plugin.xpm.project.settings.XpmModuleConfigurable"
                         parentId="preferences.xqueryAndXslt"/>
  </extensions>
</idea-plugin>
