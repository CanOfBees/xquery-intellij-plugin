<!DOCTYPE idea-plugin PUBLIC "Plugin/DTD" "https://plugins.jetbrains.com/plugin.dtd">
<idea-plugin xmlns:xi="http://www.w3.org/2001/XInclude">
  <id>uk.co.reecedunn.intellij.plugin.xquery</id>
  <!--suppress PluginXmlValidity -->
  <name>xquery-intellij-plugin</name>
  <version>VERSION</version>
  <vendor email="msclrhd@gmail.com" url="http://reecedunn.co.uk">Reece H. Dunn</vendor>

  <depends>com.intellij.modules.lang</depends>
  <depends>com.intellij.modules.xdebugger</depends>
  <depends>com.intellij.modules.xml</depends>
  <depends optional="true" config-file="plugin-depends-java.xml">com.intellij.modules.java</depends>

  <description><![CDATA[
    <p>
      XQuery language support, including all BaseX, MarkLogic, and Saxon
      vendor extensions, and the W3C Full Text, Update Facility, and
      Scripting Extensions specifications.
    </p>
    <p>&#xA0;</p>
    <p>Query processor integration:</p>
    <ol>
      <li>Run BaseX, eXist-db, MarkLogic, and Saxon queries.</li>
      <li>Profile BaseX, MarkLogic, and Saxon XQuery and XSLT.</li>
      <li>Log viewer for BaseX and MarkLogic.</li>
      <li>Built-in namespace and function support for BaseX, eXist-db, MarkLogic, and Saxon.</li>
    </ol>
    <p>IntelliJ integration:</p>
    <ol>
      <li>Robust syntax highlighting and error reporting.</li>
      <li>Inspections for several XPath/XQuery static errors.</li>
      <li>Navigate to file, namespace, variable, and function.</li>
      <li>Find usages.</li>
      <li>Function, variable, and QName prefix signature tooltips via Ctrl.</li>
      <li>Code folding.</li>
      <li>Code completion and parameter information tooltips.</li>
      <li>Structure view.</li>
      <li>Breadcrumb navigation.</li>
      <li>Paired brace matching.</li>
      <li>Commenting code.</li>
    </ol>
    <p>XPath and XSLT:</p>
    <ol>
      <li>XSLT 3.0 XMLSchema support.</li>
      <li>Experimental XPath support when the XPathView plugin is disabled.</li>
    </ol>
  ]]></description>

  <change-notes><![CDATA[
    <h3>Release 1.6-dev:</h3>
  ]]></change-notes>

  <idea-version since-build="161"/>

  <extensionPoints>
    <extensionPoint qualifiedName="uk.co.reecedunn.intellij.importPathResolver" interface="uk.co.reecedunn.intellij.plugin.xdm.model.ImportPathResolver"/>
    <extensionPoint qualifiedName="uk.co.reecedunn.intellij.queryProcessorApi" interface="uk.co.reecedunn.intellij.plugin.processor.query.QueryProcessorApi"/>
  </extensionPoints>

  <xi:include href="META-INF/plugin-compat.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="META-INF/plugin-lang-xpath.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="META-INF/plugin-lang-xquery.xml" xpointer="xpointer(/idea-plugin/*)"/>

  <extensions defaultExtensionNs="com.intellij">
    <!-- XSLT DOM Support -->

    <dom.fileDescription implementation="uk.co.reecedunn.intellij.plugin.xslt.dom.XslStylesheetDomFileDescription"/>
    <dom.fileDescription implementation="uk.co.reecedunn.intellij.plugin.xslt.dom.XslTransformDomFileDescription"/>
    <dom.fileDescription implementation="uk.co.reecedunn.intellij.plugin.xslt.dom.XslPackageDomFileDescription"/>

    <xmlStructureViewBuilderProvider implementation="uk.co.reecedunn.intellij.plugin.intellij.ide.structureView.XslStructureViewBuilderProvider"/>

    <!-- XSLT Language Support -->

    <standardResourceProvider implementation="uk.co.reecedunn.intellij.plugin.intellij.javaee.XsltResourceProvider"/>

    <multiHostInjector implementation="uk.co.reecedunn.intellij.plugin.intellij.lang.injection.XPathInXsltLanguageInjection"/>

    <completion.contributor language="XMLPath" implementationClass="uk.co.reecedunn.intellij.plugin.xpath.completion.XPathCompletionContributor"/>
    <typedHandler implementation="uk.co.reecedunn.intellij.plugin.intellij.codeInsight.editorActions.XPathTypedHandler"/>

    <!-- MarkLogic Server-Side JavaScript Language Support -->

    <fileType name="Server-side JavaScript" language="MLJavaScript" extensions="sjs"
              implementationClass="uk.co.reecedunn.intellij.plugin.intellij.fileTypes.ServerSideJavaScriptFileType"/>

    <!-- Inspections -->

    <localInspection language="XQuery" shortName="IJVS0001" bundle="messages.XQueryPluginBundle"
                     groupKey="inspection.ijvs.group-name" groupPath="XPath and XQuery"
                     key="inspection.ijvs.IJVS0001" hasStaticDescription="true"
                     enabledByDefault="true" level="WARNING"
                     implementationClass="uk.co.reecedunn.intellij.plugin.xpath.codeInspection.ijvs.IJVS0001"/>
    <localInspection language="XQuery" shortName="IJVS0002" bundle="messages.XQueryPluginBundle"
                     groupKey="inspection.ijvs.group-name" groupPath="XPath and XQuery"
                     key="inspection.ijvs.IJVS0002" hasStaticDescription="true"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="uk.co.reecedunn.intellij.plugin.xpath.codeInspection.ijvs.IJVS0002"/>
    <localInspection language="XQuery" shortName="IJVS0003" bundle="messages.XQueryPluginBundle"
                     groupKey="inspection.ijvs.group-name" groupPath="XPath and XQuery"
                     key="inspection.ijvs.IJVS0003" hasStaticDescription="true"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="uk.co.reecedunn.intellij.plugin.xpath.codeInspection.ijvs.IJVS0003"/>
    <localInspection language="XQuery" shortName="IJVS0004" bundle="messages.XQueryPluginBundle"
                     groupKey="inspection.ijvs.group-name" groupPath="XPath and XQuery"
                     key="inspection.ijvs.IJVS0004" hasStaticDescription="true"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="uk.co.reecedunn.intellij.plugin.xpath.codeInspection.ijvs.IJVS0004"/>
    <localInspection language="XQuery" shortName="IJVS0005" bundle="messages.XQueryPluginBundle"
                     groupKey="inspection.ijvs.group-name" groupPath="XPath and XQuery"
                     key="inspection.ijvs.IJVS0005" hasStaticDescription="true"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="uk.co.reecedunn.intellij.plugin.xpath.codeInspection.ijvs.IJVS0005"/>

    <localInspection language="XQuery" shortName="XPST0017" bundle="messages.XQueryPluginBundle"
                     groupKey="inspection.xpst.group-name" groupPath="XPath and XQuery"
                     key="inspection.xpst.XPST0017" hasStaticDescription="true"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="uk.co.reecedunn.intellij.plugin.xpath.codeInspection.xpst.XPST0017"/>
    <localInspection language="XQuery" shortName="XQST0031" bundle="messages.XQueryPluginBundle"
                     groupKey="inspection.xqst.group-name" groupPath="XPath and XQuery"
                     key="inspection.xqst.XQST0031" hasStaticDescription="true"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="uk.co.reecedunn.intellij.plugin.xquery.codeInspection.xqst.XQST0031"/>
    <localInspection language="XQuery" shortName="XQST0033" bundle="messages.XQueryPluginBundle"
                     groupKey="inspection.xqst.group-name" groupPath="XPath and XQuery"
                     key="inspection.xqst.XQST0033" hasStaticDescription="true"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="uk.co.reecedunn.intellij.plugin.xquery.codeInspection.xqst.XQST0033"/>
    <localInspection language="XQuery" shortName="XQST0047" bundle="messages.XQueryPluginBundle"
                     groupKey="inspection.xqst.group-name" groupPath="XPath and XQuery"
                     key="inspection.xqst.XQST0047" hasStaticDescription="true"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="uk.co.reecedunn.intellij.plugin.xquery.codeInspection.xqst.XQST0047"/>
    <localInspection language="XQuery" shortName="XPST0081" bundle="messages.XQueryPluginBundle"
                     groupKey="inspection.xpst.group-name" groupPath="XPath and XQuery"
                     key="inspection.xpst.XPST0081" hasStaticDescription="true"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="uk.co.reecedunn.intellij.plugin.xpath.codeInspection.xpst.XPST0081"/>
    <localInspection language="XQuery" shortName="XQST0118" bundle="messages.XQueryPluginBundle"
                     groupKey="inspection.xqst.group-name" groupPath="XPath and XQuery"
                     key="inspection.xqst.XQST0118" hasStaticDescription="true"
                     enabledByDefault="true" level="ERROR"
                     implementationClass="uk.co.reecedunn.intellij.plugin.xquery.codeInspection.xqst.XQST0118"/>

    <!-- Application / Project Settings -->

    <applicationService serviceImplementation="uk.co.reecedunn.intellij.plugin.intellij.settings.QueryProcessors"/>

    <!-- Run/Debug Configurations -->

    <executor implementation="uk.co.reecedunn.intellij.plugin.intellij.execution.executors.DefaultProfileExecutor"/>

    <programRunner implementation="uk.co.reecedunn.intellij.plugin.intellij.execution.runners.QueryProcessorRunner"/>
    <programRunner implementation="uk.co.reecedunn.intellij.plugin.intellij.execution.runners.QueryProcessorDebugger"/>
    <programRunner implementation="uk.co.reecedunn.intellij.plugin.intellij.execution.runners.QueryProcessorProfiler"/>

    <configurationType implementation="uk.co.reecedunn.intellij.plugin.intellij.execution.configurations.type.ServerSideJavaScriptConfigurationType"/>
    <configurationType implementation="uk.co.reecedunn.intellij.plugin.intellij.execution.configurations.type.SPARQLConfigurationType"/>
    <configurationType implementation="uk.co.reecedunn.intellij.plugin.intellij.execution.configurations.type.SQLConfigurationType"/>
    <configurationType implementation="uk.co.reecedunn.intellij.plugin.intellij.execution.configurations.type.XPathConfigurationType"/>
    <configurationType implementation="uk.co.reecedunn.intellij.plugin.intellij.execution.configurations.type.XQueryConfigurationType"/>
    <configurationType implementation="uk.co.reecedunn.intellij.plugin.intellij.execution.configurations.type.XSLTConfigurationType"/>

    <!-- Log Viewer -->

    <toolWindow id="Query Log" anchor="bottom" secondary="true" factoryClass="uk.co.reecedunn.intellij.plugin.intellij.log.QueryLogViewer"/>
  </extensions>

  <extensions defaultExtensionNs="uk.co.reecedunn.intellij">
    <importPathResolver implementation="uk.co.reecedunn.intellij.plugin.xquery.model.Annotations"/>
    <importPathResolver implementation="uk.co.reecedunn.intellij.plugin.expath.model.BuiltInFunctions"/>
    <importPathResolver implementation="uk.co.reecedunn.intellij.plugin.exquery.model.BuiltInFunctions"/>
    <importPathResolver implementation="uk.co.reecedunn.intellij.plugin.w3.model.BuiltInFunctions"/>

    <importPathResolver implementation="uk.co.reecedunn.intellij.plugin.basex.model.BuiltInFunctions"/>
    <importPathResolver implementation="uk.co.reecedunn.intellij.plugin.existdb.model.BuiltInFunctions"/>
    <importPathResolver implementation="uk.co.reecedunn.intellij.plugin.marklogic.model.BuiltInFunctions"/>
    <importPathResolver implementation="uk.co.reecedunn.intellij.plugin.saxon.model.BuiltInFunctions"/>

    <queryProcessorApi implementation="uk.co.reecedunn.intellij.plugin.basex.query.session.BaseXSession"/>
    <queryProcessorApi implementation="uk.co.reecedunn.intellij.plugin.existdb.query.rest.EXistDBRest"/>
    <queryProcessorApi implementation="uk.co.reecedunn.intellij.plugin.marklogic.query.rest.MarkLogicRest"/>
    <queryProcessorApi implementation="uk.co.reecedunn.intellij.plugin.saxon.query.s9api.SaxonS9API"/>
  </extensions>
</idea-plugin>
